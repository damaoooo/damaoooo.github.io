<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUCTF Reverse WriteUp 2 | damaoooo's blog</title><meta name="description" content="BUUCTF Reverse WriteUp 2简单注册器是个APK，使用dex2jar反编译之后用jd(java decompiler)查看内容 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667p"><meta name="keywords" content="Re"><meta name="author" content="damaoooo"><meta name="copyright" content="damaoooo"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/08/09/BUUCTF%20Reverse%20WriteUp%202/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="BUUCTF Reverse WriteUp 2"><meta property="og:url" content="http://yoursite.com/2020/08/09/BUUCTF%20Reverse%20WriteUp%202/"><meta property="og:site_name" content="damaoooo's blog"><meta property="og:description" content="BUUCTF Reverse WriteUp 2简单注册器是个APK，使用dex2jar反编译之后用jd(java decompiler)查看内容 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667p"><meta property="og:image" content="https://img.buuoj.cn/buugirl/img/1.png"><meta property="article:published_time" content="2020-08-09T12:34:33.000Z"><meta property="article:modified_time" content="2020-08-09T14:03:34.000Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'true'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-right"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-08-09 17:03:34'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="https://i.loli.net/2020/07/30/shRu65oYXAlyOwp.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">41</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/bangumi/"><i class="fa-fw fas fa-film"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-Reverse-WriteUp-2"><span class="toc-number">1.</span> <span class="toc-text">BUUCTF Reverse WriteUp 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8"><span class="toc-number">1.1.</span> <span class="toc-text">简单注册器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lucky-guy"><span class="toc-number">1.2.</span> <span class="toc-text">lucky guy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">1.3.</span> <span class="toc-text">rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CrackRTF"><span class="toc-number">1.4.</span> <span class="toc-text">CrackRTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pyre"><span class="toc-number">1.5.</span> <span class="toc-text">pyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#younger-driver"><span class="toc-number">1.6.</span> <span class="toc-text">younger driver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%86%8C"><span class="toc-number">1.7.</span> <span class="toc-text">相册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE"><span class="toc-number">1.8.</span> <span class="toc-text">2019红帽杯 easyRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-JustRE"><span class="toc-number">1.9.</span> <span class="toc-text">BJDCTF JustRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2019-signin"><span class="toc-number">1.10.</span> <span class="toc-text">SUCTF2019 signin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V-amp-N2020-StrangeCPP"><span class="toc-number">1.11.</span> <span class="toc-text">V&amp;N2020 StrangeCPP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF-2020-EasyRE"><span class="toc-number">1.12.</span> <span class="toc-text">ACTF 2020 EasyRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUET-CTF-re"><span class="toc-number">1.13.</span> <span class="toc-text">GUET-CTF re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn4-login"><span class="toc-number">1.14.</span> <span class="toc-text">FlareOn4 login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V-amp-N-2020-CSRe"><span class="toc-number">1.15.</span> <span class="toc-text">V&amp;N 2020 CSRe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-easy"><span class="toc-number">1.16.</span> <span class="toc-text">BJDCTF easy</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://img.buuoj.cn/buugirl/img/1.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">damaoooo's blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/bangumi/"><i class="fa-fw fas fa-film"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">BUUCTF Reverse WriteUp 2</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-09T12:34:33.000Z" title="发表于 2020-08-09 15:34:33">2020-08-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-08-09T14:03:34.000Z" title="更新于 2020-08-09 17:03:34">2020-08-09</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="BUUCTF-Reverse-WriteUp-2"><a href="#BUUCTF-Reverse-WriteUp-2" class="headerlink" title="BUUCTF Reverse WriteUp 2"></a>BUUCTF Reverse WriteUp 2</h1><h2 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h2><p>是个APK，使用<code>dex2jar</code>反编译之后用<code>jd(java decompiler)</code>查看内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.ActionBarActivity;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">ActionBarActivity</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle paramBundle)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(paramBundle);</span><br><span class="line">    setContentView(<span class="number">2130903063</span>);</span><br><span class="line">    <span class="keyword">if</span> (paramBundle == <span class="keyword">null</span>)</span><br><span class="line">      getSupportFragmentManager().beginTransaction().add(<span class="number">2131034172</span>, <span class="keyword">new</span> PlaceholderFragment()).commit(); </span><br><span class="line">    Button button = (Button)findViewById(<span class="number">2131034175</span>);</span><br><span class="line">    <span class="keyword">final</span> TextView textview = (TextView)findViewById(<span class="number">2131034174</span>);</span><br><span class="line">    button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View param1View)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">            String str = editview.getText().toString();</span><br><span class="line">            <span class="keyword">if</span> (str.length() != <span class="number">32</span> || str.charAt(<span class="number">31</span>) != <span class="string">&#x27;a&#x27;</span> || str.charAt(<span class="number">1</span>) != <span class="string">&#x27;b&#x27;</span> || str.charAt(<span class="number">0</span>) + str.charAt(<span class="number">2</span>) - <span class="number">48</span> != <span class="number">56</span>)</span><br><span class="line">              i = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">              <span class="keyword">char</span>[] arrayOfChar = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span>.toCharArray();</span><br><span class="line">              arrayOfChar[<span class="number">2</span>] = (<span class="keyword">char</span>)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">3</span>] - <span class="number">50</span>);</span><br><span class="line">              arrayOfChar[<span class="number">4</span>] = (<span class="keyword">char</span>)(arrayOfChar[<span class="number">2</span>] + arrayOfChar[<span class="number">5</span>] - <span class="number">48</span>);</span><br><span class="line">              arrayOfChar[<span class="number">30</span>] = (<span class="keyword">char</span>)(arrayOfChar[<span class="number">31</span>] + arrayOfChar[<span class="number">9</span>] - <span class="number">48</span>);</span><br><span class="line">              arrayOfChar[<span class="number">14</span>] = (<span class="keyword">char</span>)(arrayOfChar[<span class="number">27</span>] + arrayOfChar[<span class="number">28</span>] - <span class="number">97</span>);</span><br><span class="line">              <span class="keyword">for</span> (i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line">                String str1;</span><br><span class="line">                <span class="keyword">if</span> (i &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">                  str1 = String.valueOf(arrayOfChar);</span><br><span class="line">                  textview.setText(<span class="string">&quot;flag&#123;&quot;</span> + str1 + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span>;</span><br><span class="line">                &#125; </span><br><span class="line">                String str2 = str1[<span class="number">31</span> - i];</span><br><span class="line">                str1[<span class="number">31</span> - i] = str1[i];</span><br><span class="line">                str1[i] = str2;</span><br><span class="line">              &#125; </span><br><span class="line">            &#125; </span><br><span class="line">            textview.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu paramMenu)</span> </span>&#123;</span><br><span class="line">    getMenuInflater().inflate(<span class="number">2131492864</span>, paramMenu);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem paramMenuItem)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (paramMenuItem.getItemId() == <span class="number">2131034176</span>) ? <span class="keyword">true</span> : <span class="keyword">super</span>.onOptionsItemSelected(paramMenuItem);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaceholderFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater param1LayoutInflater, ViewGroup param1ViewGroup, Bundle param1Bundle)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> param1LayoutInflater.inflate(<span class="number">2130903064</span>, param1ViewGroup, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输入字符进行校验，符合条件的，就把这个字符串几位数进行操作之后取反，写个脚本跑一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;dd2940c04462b4dd7c450528835cca15&#x27;</span></span><br><span class="line">s = list(s)</span><br><span class="line">s = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> s]</span><br><span class="line">s[<span class="number">2</span>] = (s[<span class="number">2</span>] + s[<span class="number">3</span>] - <span class="number">50</span>)</span><br><span class="line">s[<span class="number">4</span>] = (s[<span class="number">2</span>] + s[<span class="number">5</span>] - <span class="number">48</span>)</span><br><span class="line">s[<span class="number">30</span>] = (s[<span class="number">31</span>] + s[<span class="number">9</span>] - <span class="number">48</span>)</span><br><span class="line">s[<span class="number">14</span>] = (s[<span class="number">27</span>] + s[<span class="number">28</span>] - <span class="number">97</span>)</span><br><span class="line">s.reverse()</span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> s]))</span><br></pre></td></tr></table></figure>

<p>出了<code>flag&#123;59acc538825054c7de4b26440c0999dd&#125;</code></p>
<h2 id="lucky-guy"><a href="#lucky-guy" class="headerlink" title="lucky guy"></a>lucky guy</h2><p>下载下来的结果是个X86-64的ELF，发现F5失败</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/01/mdVwqKR5c41NDuM.png" alt="image-20200801230102154"></p>
<p>得，那就分析汇编，发现是一个输入数字，然后取随机数出flag的</p>
<p>找到出flag的逻辑，都不用打patch，直接手动分析就是了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">get_flag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  __int64 s; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v0 = time(<span class="number">0L</span>L);</span><br><span class="line">  srand(v0);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( rand() % <span class="number">200</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;OK, it&#x27;s flag:&quot;</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x28</span>uLL);</span><br><span class="line">        <span class="built_in">strcat</span>((<span class="keyword">char</span> *)&amp;s, f1);</span><br><span class="line">        <span class="built_in">strcat</span>((<span class="keyword">char</span> *)&amp;s, &amp;f2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;s);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Solar not like you&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Solar want a girlfriend&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v6 = <span class="number">0</span>;</span><br><span class="line">        s = &#x27;fo`guci&#x27;;</span><br><span class="line">        <span class="built_in">strcat</span>(&amp;f2, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;s);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> )</span><br><span class="line">            v1 = *(&amp;f2 + j) - <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            v1 = *(&amp;f2 + j) - <span class="number">1</span>;</span><br><span class="line">          *(&amp;f2 + j) = v1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;emmm,you can&#x27;t find flag 23333&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>f1可以直接找到，写个脚本出f2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;fo`guci&#x27;</span></span><br><span class="line">s = list(s)</span><br><span class="line">s = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> s]</span><br><span class="line">s.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">        s[i] -= <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s[i] -= <span class="number">1</span></span><br><span class="line">f1 = <span class="string">&#x27;GXY&#123;do_not_&#x27;</span></span><br><span class="line">print(f1 + <span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> s]))</span><br></pre></td></tr></table></figure>

<p>出结果<code>GXY&#123;do_not_hate_me&#125;</code></p>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>下载下来是一个key一个enc，rsa算法就是要去找e，d，还有欧拉函数</p>
<p>key里面是一个base64的公钥，enc打不开，估计是加密后的字节串，有了公钥key，而且长度不算长，就可以带入到<code>factordb.com</code>里面去找一下因数分解，然后求欧拉函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">N = <span class="string">&#x27;MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+/AvKr1rzQczdAgMBAAE=&#x27;</span></span><br><span class="line">N = base64.b64decode(N)</span><br><span class="line">N = [hex(x)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> N]</span><br><span class="line">print(<span class="string">&#x27;0x&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join(N))</span><br></pre></td></tr></table></figure>

<p><code>key = 0x303c300d06092a864886f70d0101010500032b003028022100c0332c5c64ae47182f6c1c876d42336910545a58f7eefefc0bcaaf5af341ccdd0203010001</code></p>
<p>查到了因式分解的结果</p>
<p><code>7246255757203408838535614667498219793647193424559346880212407078558298027963762366749937521991103661174290022755026478321354431589 * 3^6 * 7 * 53 * 70957 * 277198451</code></p>
<p>欧拉函数可以出来了</p>
<p><code>phi = 0x1b0ae025206ee6e222bc368d42f8eed88d062df5ab5f7cc8d9bcca82519cbbdd8dc1354991b61e95e1109843ececeb5954dd14e0c086175c7aedeb8ace00L</code> </p>
<p>然后就是求phi关于65537的逆元，就是我们的d</p>
<p><code>d = gmpy.invert(65537, phi)</code></p>
<p>得到<code>d = 0x6bdf061f1331506dde814a5a543d0b056806ae6ebc1d3a7737978f7828753e3099b58c0adbe3ce3db07bb1e7c2c1904dd7e7cdd07c2a6825cf78218ca01</code></p>
<p>得到了d之后只需要对密文进行<br>$$<br>cipher^{d} % N=plain<br>$$<br>然后就是读取文件<code>enc</code>转化为hex了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;rsa\\41c4e672-98c5-43e5-adf4-49d75db307e4\\output\\flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line">c = [hex(x)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> c]</span><br><span class="line">print(<span class="string">&#x27;0x&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join(c))</span><br></pre></td></tr></table></figure>

<p><code>c = 0x4196c0594a5e000a96b878b67cd724795b13a8f2ca54da06d0f19c28be689b62</code></p>
<p>然后就是<code>pow(c, d, N)</code>，结果是<code>0x10b2ee66d8c3be7d67bbeb85060700e9e4f598f627f746931aadb7a7bc17db0d573267c99c8e326e5e8458b63794ccc20493d26bfc0d147028808b91a6c0</code></p>
<p>？？？这根本不是可以解出来的字符串啊</p>
<p>用在线<code>rsa</code>加解密出来也完全不是什么东西啊</p>
<p>得，网上找了下在线公钥分析，发现公钥解析错了，不能直接用我的方法直接从base64来解析，他这个还有固定格式的</p>
<p>拖进<code>http://tool.chacuo.net/cryptrsakeyparse</code>里面，得到</p>
<p><code>n = C0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD</code></p>
<p>分解得到<code> 285960468890451637935629440372639283459</code>和<code>304008741604601924494328155975272418463</code></p>
<p>然后就是算欧拉函数<code>phi = 81176168860169991027846870170527607562179635470395365333547868786951080991441L</code> </p>
<p>求出逆元<code>d = 0xb378155840fb2b8fbdd869db5b7e91994f1ece256ee1175ec2c2bd3a4a795ad1</code></p>
<p>最后解密还得靠python的<code>rsa</code>模块来对文件进行解密，其实这个最难不是解密，是配置gmpy2的环境，嗨，说多了都是泪啊，windows下我现在还没配好</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xC0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p =  <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">phi = <span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line">d = <span class="number">0xb378155840fb2b8fbdd869db5b7e91994f1ece256ee1175ec2c2bd3a4a795ad1</span></span><br><span class="line">privKey = rsa.PrivateKey(n, e, d, p, q)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">&#x27;./flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line">    print(rsa.decrypt(content, privKey))</span><br></pre></td></tr></table></figure>

<p>最后flag<code>flag&#123;decrypt_256&#125;</code></p>
<p>这不应该是crypto题吗……</p>
<h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>记事本图标的exe，x86平台，拖进IDA，找到main函数逻辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main_0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  DWORD v0; <span class="comment">// eax</span></span><br><span class="line">  DWORD v1; <span class="comment">// eax</span></span><br><span class="line">  CHAR pass2; <span class="comment">// [esp+4Ch] [ebp-310h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+150h] [ebp-20Ch]</span></span><br><span class="line">  CHAR s; <span class="comment">// [esp+154h] [ebp-208h]</span></span><br><span class="line">  BYTE pass1; <span class="comment">// [esp+258h] [ebp-104h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;pass1, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;pls input the first passwd(1): &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;pass1);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pass1) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = atoi((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pass1);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">strcat</span>((<span class="keyword">char</span> *)&amp;pass1, <span class="string">&quot;@DBApp&quot;</span>);</span><br><span class="line">  v0 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pass1);</span><br><span class="line">  j_sha1(&amp;pass1, v0, &amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !_strcmpi(&amp;s, <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;continue...\n\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pls input the first passwd(2): &quot;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;pass2, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;pass2);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;pass2) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Must be 6 characters!\n&quot;</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcat</span>(&amp;pass2, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pass1);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(&amp;pass2);</span><br><span class="line">    j_getMd5((BYTE *)&amp;pass2, v1, &amp;s);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span>, &amp;s) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> __int8)sub_40100F(&amp;pass2) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error!!\n&quot;</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;bye ~~\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看了一下逻辑，大概是对第一个字符串加盐hash，然后成功了之后拼到第二个字符串上面，我居然没查到这个hash和md5，只能暴力破解了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">salt = <span class="string">&#x27;@DBApp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>, <span class="number">1000000</span>):</span><br><span class="line">    data = str(i)+salt</span><br><span class="line">    hash_sha1 = hashlib.sha1(data.encode())</span><br><span class="line">    <span class="keyword">if</span> hash_sha1.hexdigest().upper() == <span class="string">&#x27;6E32D0943418C2C33385BC35A1470250DD8923A9&#x27;</span>:</span><br><span class="line">        print(data)</span><br></pre></td></tr></table></figure>

<p>爆出来第一个是123321，第二个继续爆，发现不是数字，直接查</p>
<p><code>~!3a@0123321@DBApp</code>出来了，然而不对？？？</p>
<p>继续跟进去看看这个第三个判断函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> __cdecl <span class="title">sub_4014D0</span><span class="params">(LPCSTR lpString)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  LPCVOID lpBuffer; <span class="comment">// [esp+50h] [ebp-1Ch]</span></span><br><span class="line">  DWORD NumberOfBytesWritten; <span class="comment">// [esp+58h] [ebp-14h]</span></span><br><span class="line">  DWORD nNumberOfBytesToWrite; <span class="comment">// [esp+5Ch] [ebp-10h]</span></span><br><span class="line">  HGLOBAL hResData; <span class="comment">// [esp+60h] [ebp-Ch]</span></span><br><span class="line">  HRSRC hResInfo; <span class="comment">// [esp+64h] [ebp-8h]</span></span><br><span class="line">  HANDLE hFile; <span class="comment">// [esp+68h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  hFile = <span class="number">0</span>;</span><br><span class="line">  hResData = <span class="number">0</span>;</span><br><span class="line">  nNumberOfBytesToWrite = <span class="number">0</span>;</span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hResInfo = FindResourceA(<span class="number">0</span>, (LPCSTR)<span class="number">0x65</span>, <span class="string">&quot;AAA&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !hResInfo )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  nNumberOfBytesToWrite = SizeofResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">  hResData = LoadResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">  <span class="keyword">if</span> ( !hResData )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  lpBuffer = LockResource(hResData);</span><br><span class="line">  sub_401005(lpString, (<span class="keyword">int</span>)lpBuffer, nNumberOfBytesToWrite);</span><br><span class="line">  hFile = CreateFileA(<span class="string">&quot;dbapp.rtf&quot;</span>, <span class="number">0x10000000</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( hFile == (HANDLE)<span class="number">-1</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, &amp;NumberOfBytesWritten, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  CloseHandle(hFile);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是从程序本身的一个区段里面取出数据，同刚才的数据进行<code>xor</code>得到flag写入在<code>dbapp.rtf</code>里面，然后也懒得继续跟了，直接打开文件，出flag</p>
<p><code>Flag&#123;N0_M0re_Free_Bugs&#125;</code></p>
<h2 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h2><p>下载下来是个pyc文件，直接uncompiler 反编译</p>
<p><code>uncompyle6.exe a.pyc &gt; a.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.2</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.7.0 (v3.7.0:1bf9cc5093, Jun 27 2018, 04:59:51) [MSC v.1914 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: encode.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2019-08-19 21:01:57</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = len(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[(i + <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> code</span><br><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"><span class="comment"># okay decompiling .\attachment.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>是个根本跑不起来的py2，而且这个<code>code += num</code>操作我是有点醉的，不晓得他是啥意思，我在python2/3里面都试过了一下，没啥用，报错，就猜他是<code>code[i] += num</code></p>
<p><code>((a+b) % p + c) % p = (a + (b+c) % p) % p </code>可以优化一下里面的取余那一步</p>
<p><code>num = ((input1[i] + i) % 128 + 128) % 128 = (input1[i] + i) % 128</code>（假定flag的长度不超多128）</p>
<p>而这个<code>ascii</code>最多有126个字符，那就好办了啊，写个脚本跑一下就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">table = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> string.printable]</span><br><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line">code = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> code]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(code)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    code[i] ^= code[i+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(code)):</span><br><span class="line">    code[i] -= i</span><br><span class="line">    <span class="keyword">if</span> code[i] <span class="keyword">not</span> <span class="keyword">in</span> table <span class="keyword">or</span> code[i] &lt;= <span class="number">10</span>:</span><br><span class="line">        code[i] += <span class="number">128</span></span><br><span class="line"></span><br><span class="line">print(code)</span><br><span class="line">code = [chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> code]</span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join(code))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>GWHT&#123;Just_Re_1s_Ha66y!&#125;</code></p>
<h2 id="younger-driver"><a href="#younger-driver" class="headerlink" title="younger driver"></a>younger driver</h2><p>拖进PEID查壳，是个UPX的壳，脱壳机脱了，是个32位exe</p>
<p>主要函数逻辑比较清晰，改名后如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main_0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HANDLE v1; <span class="comment">// [esp+D0h] [ebp-14h]</span></span><br><span class="line">  HANDLE hObject; <span class="comment">// [esp+DCh] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  j_inputFlag();</span><br><span class="line">  ::hObject = CreateMutexW(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  j_strcpy(input_dest, input_flag);</span><br><span class="line">  hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, StartAddress, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  v1 = CreateThread(<span class="number">0</span>, <span class="number">0</span>, sub_41119F, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  CloseHandle(hObject);</span><br><span class="line">  CloseHandle(v1);</span><br><span class="line">  <span class="keyword">while</span> ( indexer != <span class="number">-1</span> )</span><br><span class="line">    ;</span><br><span class="line">  j_compare();</span><br><span class="line">  CloseHandle(::hObject);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后<code>startAddress</code>函数是用于变换的，最后的compare是用于比较变换后的flag和data是否相同</p>
<p>但是我电脑上没有<code>MSVCRT100D.dll</code>跑不起来，于是只好静态分析他的变换函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *__cdecl <span class="title">func1</span><span class="params">(<span class="keyword">int</span> *input_flag, <span class="keyword">int</span> *indexer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> chr; <span class="comment">// [esp+D3h] [ebp-5h]</span></span><br><span class="line"></span><br><span class="line">  chr = *(input_flag + indexer);</span><br><span class="line">  <span class="keyword">if</span> ( (chr &lt; <span class="string">&#x27;a&#x27;</span> || chr &gt; <span class="string">&#x27;z&#x27;</span>) &amp;&amp; (chr &lt; <span class="string">&#x27;A&#x27;</span> || chr &gt; <span class="string">&#x27;Z&#x27;</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( chr &lt; <span class="string">&#x27;a&#x27;</span> || chr &gt; <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = data[<span class="number">0</span>];</span><br><span class="line">    *(input_flag + indexer) = data[<span class="number">0</span>][*(input_flag + indexer) - <span class="number">0x26</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = data[<span class="number">0</span>];</span><br><span class="line">    *(input_flag + indexer) = data[<span class="number">0</span>][*(input_flag + indexer) - <span class="number">0x60</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>他这个data就是键盘密码表，算法简而言之就是大写变小写小写变大写然后按照键盘顺序来加密</p>
<p>写个脚本爆破一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span> + <span class="string">&#x27;\0&#x27;</span></span><br><span class="line">data = <span class="string">&#x27;TOiZiZtOrYaToUwPnToBsOaOapsyS&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">data</span>):</span></span><br><span class="line">    ret = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        idx = table.find(i)</span><br><span class="line">        <span class="keyword">if</span> i.islower():</span><br><span class="line">            ret.append(chr(idx + <span class="number">0x60</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ret.append(chr(idx + <span class="number">0x26</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ret)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encry</span>(<span class="params">data:str</span>):</span></span><br><span class="line">    ret = list(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">        <span class="keyword">if</span> data[i].isupper():</span><br><span class="line">            idx = ord(data[i]) - <span class="number">0x26</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            idx = ord(data[i]) - <span class="number">0x60</span></span><br><span class="line">        ret[i] = table[idx]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ret)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">        <span class="keyword">if</span>(encry(j) == data[i]):</span><br><span class="line">            flag += j</span><br><span class="line">print(flag)</span><br><span class="line">e = encry(flag)</span><br><span class="line">print(e)</span><br></pre></td></tr></table></figure>

<p>解出来flag是<code>dhGsGsDhCeJdHfAiXdHwKhJhJIKEk</code>，但是交了一下，居然不对……</p>
<p>可惜跑不了，不能debug，让我装一个<code>msvcrt100d.dll</code>看看能不能调出来，好家伙还加了反调试，他会检测你的进程列表里有没有<code>od</code>和<code>ida</code>之类的东西，但是我可用x32dbg啊</p>
<p>只是没有ida在旁边我比较难定位罢了，把这个给patch掉就好得多</p>
<p>patch完成，然后直接用ida调试我看看到底发生了什么</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/08/04/9fFscDNwRTQlnUK.png" alt="image-20200804003646479"></p>
<p>然后就发现调不通，还有一个栈顶指针错误，OD里面跟到这儿也直接卡死，硬给patch直接报错，淦</p>
<p>看看多线程到底说了啥</p>
<p>得，问题就在这，有个互斥锁，等锁，变换，然后减一，又等锁，淦</p>
<p>出了，完整脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span> + <span class="string">&#x27;\0&#x27;</span></span><br><span class="line">data = <span class="string">&#x27;TOiZiZtOrYaToUwPnToBsOaOapsyS&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encry</span>(<span class="params">data:str</span>):</span></span><br><span class="line">    ret = list(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">        <span class="keyword">if</span> data[i].isupper():</span><br><span class="line">            idx = ord(data[i]) - <span class="number">0x26</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            idx = ord(data[i]) - <span class="number">0x60</span></span><br><span class="line">        ret[i] = table[idx]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ret)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">        <span class="keyword">if</span>(encry(j) == data[i]):</span><br><span class="line">            flag += j</span><br><span class="line"></span><br><span class="line">mutex = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)):</span><br><span class="line">    <span class="keyword">if</span> mutex == <span class="number">0</span>:</span><br><span class="line">        print(data[i], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        mutex = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(flag[i], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        mutex = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p><code>ThisisthreadofwindowshahaIsES</code>，最后一位会变成<code>\0</code>，影响不大，反正最后一位都会变成结束符，应该是多解，但是怎么交都交不对，随后看了下网上的wp，原来预设是E，比赛的时候最后一位什么都是对的，但是这个平台只是设置了E，淦</p>
<h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>提示是个病毒，不要安装到手机里，下载下来居然还有系统报毒，有点东西</p>
<p>是个手机apk，用dex2jar反编译然后用<code>jd</code>打开看看</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sendMailByJavaMail</span><span class="params">(String paramString1, String paramString2, String paramString3)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (debug)</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">    Mail mail = <span class="keyword">new</span> Mail(C2.MAILUSER, C2.MAILPASS);</span><br><span class="line">    mail.set_host(<span class="string">&quot;smtp.163.com&quot;</span>);</span><br><span class="line">    mail.set_port(<span class="string">&quot;25&quot;</span>);</span><br><span class="line">    mail.set_debuggable(<span class="keyword">true</span>);</span><br><span class="line">    mail.set_to(<span class="keyword">new</span> String[] &#123; paramString1 &#125;);</span><br><span class="line">    mail.set_from(C2.MAILFROME);</span><br><span class="line">    mail.set_subject(paramString2);</span><br><span class="line">    mail.setBody(paramString3);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (mail.send()) &#123;</span><br><span class="line">        Log.i(<span class="string">&quot;IcetestActivity&quot;</span>, <span class="string">&quot;Email was sent successfully.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception exception) &#123;</span><br><span class="line">      Log.e(<span class="string">&quot;MailApp&quot;</span>, <span class="string">&quot;Could not send email&quot;</span>, exception);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    Log.i(<span class="string">&quot;IcetestActivity&quot;</span>, <span class="string">&quot;Email was sent failed.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>然后取C2里面找找</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C2</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CANCELNUMBER = <span class="string">&quot;%23%2321%23&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILFROME;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILHOST = <span class="string">&quot;smtp.163.com&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILPASS;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILSERVER = Base64.decode(NativeMethod.m());</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILUSER = Base64.decode(NativeMethod.m());</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MOVENUMBER = <span class="string">&quot;**21*121%23&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String PORT = <span class="string">&quot;25&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String date = <span class="string">&quot;2115-11-1&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String phoneNumber;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    MAILPASS = Base64.decode(NativeMethod.pwd());</span><br><span class="line">    MAILFROME = Base64.decode(NativeMethod.m());</span><br><span class="line">    phoneNumber = Base64.decode(NativeMethod.p());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后去<code>NativeMethod</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.net.cn;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeMethod</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">m</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">p</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">pwd</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得，是个外部方法，用apktools解压一下，找到so文件，拖进IDA</p>
<p>进入m方法，看见一个base64字符串，出结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.text:00000C80 Java_com_net_cn_NativeMethod_m          ; DATA XREF: LOAD:00000174↑o</span><br><span class="line">.text:00000C80 ; __unwind &#123;</span><br><span class="line">.text:00000C80                 PUSH    &#123;R3,LR&#125;</span><br><span class="line">.text:00000C82                 LDR     R2, [R0]</span><br><span class="line">.text:00000C84                 LDR     R1, &#x3D;(aMtgymtg0njuxmj_0 - 0xC8E)</span><br><span class="line">.text:00000C86                 MOVS    R3, #0x29C</span><br><span class="line">.text:00000C8A                 ADD     R1, PC          ; &quot;MTgyMTg0NjUxMjVAMTYzLmNvbQ&#x3D;&#x3D;&quot;</span><br><span class="line">.text:00000C8C                 LDR     R3, [R2,R3]</span><br><span class="line">.text:00000C8E                 BLX     R3</span><br><span class="line">.text:00000C90                 POP     &#123;R3,PC&#125;</span><br><span class="line">.text:00000C90 ; End of function Java_com_net_cn_NativeMethod_m</span><br><span class="line">.text:00000C90</span><br></pre></td></tr></table></figure>

<p><code>18218465125@163.com</code></p>
<h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="2019红帽杯 easyRE"></a>2019红帽杯 easyRE</h2><p>是个elf，用wsl跑起来啥都不弹出啊</p>
<p>通过字符串查找大法找到关键函数，然后从print都没有得情况来看，应该是strip过了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> __int64 <span class="title">sub_4009C6</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// rdi</span></span><br><span class="line">  __int64 input_len; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// ST10_8</span></span><br><span class="line">  __int64 v7; <span class="comment">// ST18_8</span></span><br><span class="line">  __int64 v8; <span class="comment">// ST20_8</span></span><br><span class="line">  __int64 v9; <span class="comment">// ST28_8</span></span><br><span class="line">  __int64 v10; <span class="comment">// ST30_8</span></span><br><span class="line">  __int64 v11; <span class="comment">// ST38_8</span></span><br><span class="line">  __int64 v12; <span class="comment">// ST40_8</span></span><br><span class="line">  __int64 v13; <span class="comment">// ST48_8</span></span><br><span class="line">  __int64 v14; <span class="comment">// ST50_8</span></span><br><span class="line">  __int64 v15; <span class="comment">// ST58_8</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line">  <span class="keyword">char</span> data[<span class="number">39</span>]; <span class="comment">// [rsp+60h] [rbp-C0h]</span></span><br><span class="line">  <span class="keyword">char</span> input[<span class="number">32</span>]; <span class="comment">// [rsp+90h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [rsp+B0h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+B4h] [rbp-6Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+C0h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+E7h] [rbp-39h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+100h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v24; <span class="comment">// [rsp+108h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v24 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  data[<span class="number">0</span>] = <span class="string">&#x27;I&#x27;</span>;</span><br><span class="line">  data[<span class="number">1</span>] = <span class="string">&#x27;o&#x27;</span>;</span><br><span class="line">  data[<span class="number">2</span>] = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">  data[<span class="number">3</span>] = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">  data[<span class="number">4</span>] = <span class="string">&#x27;&gt;&#x27;</span>;</span><br><span class="line">  data[<span class="number">5</span>] = <span class="string">&#x27;Q&#x27;</span>;</span><br><span class="line">  data[<span class="number">6</span>] = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">  data[<span class="number">7</span>] = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">  data[<span class="number">8</span>] = <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">  data[<span class="number">9</span>] = <span class="string">&#x27;o&#x27;</span>;</span><br><span class="line">  data[<span class="number">10</span>] = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">  data[<span class="number">11</span>] = <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">  data[<span class="number">12</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  data[<span class="number">13</span>] = <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">  data[<span class="number">14</span>] = <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">  data[<span class="number">15</span>] = <span class="string">&#x27;i&#x27;</span>;</span><br><span class="line">  data[<span class="number">16</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  data[<span class="number">17</span>] = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">  data[<span class="number">18</span>] = <span class="string">&#x27;`&#x27;</span>;</span><br><span class="line">  data[<span class="number">19</span>] = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">  data[<span class="number">20</span>] = <span class="string">&#x27;w&#x27;</span>;</span><br><span class="line">  data[<span class="number">21</span>] = <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">  data[<span class="number">22</span>] = <span class="string">&#x27;w&#x27;</span>;</span><br><span class="line">  data[<span class="number">23</span>] = <span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">  data[<span class="number">24</span>] = <span class="string">&#x27;k&#x27;</span>;</span><br><span class="line">  data[<span class="number">25</span>] = <span class="string">&#x27;9&#x27;</span>;</span><br><span class="line">  data[<span class="number">26</span>] = <span class="string">&#x27;&#123;&#x27;</span>;</span><br><span class="line">  data[<span class="number">27</span>] = <span class="string">&#x27;i&#x27;</span>;</span><br><span class="line">  data[<span class="number">28</span>] = <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">  data[<span class="number">29</span>] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">  data[<span class="number">30</span>] = <span class="string">&#x27;~&#x27;</span>;</span><br><span class="line">  data[<span class="number">31</span>] = <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">  data[<span class="number">32</span>] = <span class="string">&#x27;L&#x27;</span>;</span><br><span class="line">  data[<span class="number">33</span>] = <span class="string">&#x27;@&#x27;</span>;</span><br><span class="line">  data[<span class="number">34</span>] = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">  data[<span class="number">35</span>] = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">  <span class="built_in">memset</span>(input, <span class="number">0</span>, <span class="keyword">sizeof</span>(input));</span><br><span class="line">  v19 = <span class="number">0</span>;</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  v0 = input;</span><br><span class="line">  sub_4406E0(<span class="number">0L</span>L, input, <span class="number">37L</span>L);</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  v1 = input;</span><br><span class="line">  LODWORD(input_len) = <span class="built_in">strlen</span>((<span class="keyword">const</span> __m128i *)input);</span><br><span class="line">  <span class="keyword">if</span> ( input_len == <span class="number">0x24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = input;</span><br><span class="line">      LODWORD(v4) = <span class="built_in">strlen</span>((<span class="keyword">const</span> __m128i *)input);</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= v4 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)(input[i] ^ i) != data[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">0xFFFFFFFE</span>LL;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    print(<span class="string">&quot;continue!&quot;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;v21, <span class="number">0</span>, <span class="number">0x40</span>uLL);</span><br><span class="line">    v23 = <span class="number">0</span>;</span><br><span class="line">    v0 = &amp;v21;</span><br><span class="line">    sub_4406E0(<span class="number">0L</span>L, &amp;v21, <span class="number">64L</span>L);</span><br><span class="line">    v22 = <span class="number">0</span>;</span><br><span class="line">    v1 = &amp;v21;</span><br><span class="line">    LODWORD(v5) = <span class="built_in">strlen</span>((<span class="keyword">const</span> __m128i *)&amp;v21);</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">39</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = transf2((__int64)&amp;v21);</span><br><span class="line">      v7 = transf2(v6);</span><br><span class="line">      v8 = transf2(v7);</span><br><span class="line">      v9 = transf2(v8);</span><br><span class="line">      v10 = transf2(v9);</span><br><span class="line">      v11 = transf2(v10);</span><br><span class="line">      v12 = transf2(v11);</span><br><span class="line">      v13 = transf2(v12);</span><br><span class="line">      v14 = transf2(v13);</span><br><span class="line">      v15 = transf2(v14);</span><br><span class="line">      v0 = fool;</span><br><span class="line">      v1 = (<span class="keyword">char</span> *)v15;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400360(v15, fool) )</span><br><span class="line">      &#123;</span><br><span class="line">        print(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        v1 = <span class="string">&quot;bye bye~&quot;</span>;</span><br><span class="line">        print(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">0xFFFFFFFD</span>LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v24 )</span><br><span class="line">    sub_444020(v1, v0);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中这个<code>off_6CC090</code>是可以无数次base64解码最后获取到一篇文章<code>https://bbs.pediy.com/thread-254172.htm</code>讲的是如何挖坑，啊，那么我岂不是……淦</p>
<p>跟进这个<code>transf1</code>来看看，淦哦全是mm128，看的一脸懵逼，动态调试一下看看，原来是判断字符串长度的</p>
<p>然后就是构造一个输入了，亦或一下就出来了</p>
<p><code>Info:The first four chars are flag</code></p>
<p>？？？什么迷惑玩意，然后就是第二个输入，跟了一下，是循环base64之后要等于这个网址，怎么有种强烈的上当受骗的感觉</p>
<p>试试提交一下这个玩意，不对，我就很纳闷了……完全是被耍了啊</p>
<p>看看<code>writeUP</code>，原来<code>fini</code>段还藏着代码，找到<code>main_fake</code>下面一个函数，进去就是关键算法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_400D35</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rdi</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// rt1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> *v5; <span class="comment">// [rsp+Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v2 = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">for</span> ( v5 = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)((<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_43FD20(<span class="number">0L</span>L) - (<span class="keyword">unsigned</span> <span class="keyword">int</span>)qword_6CEE38);</span><br><span class="line">        SHIDWORD(v5) &lt;= <span class="number">1233</span>;</span><br><span class="line">        ++HIDWORD(v5) )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v5;</span><br><span class="line">    sub_40F790((<span class="keyword">unsigned</span> <span class="keyword">int</span>)v5);</span><br><span class="line">    sub_40FE60();</span><br><span class="line">    sub_40FE60();</span><br><span class="line">    LODWORD(v5) = (<span class="keyword">unsigned</span> __int64)sub_40FE60() ^ <span class="number">0x98765432</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = (<span class="keyword">signed</span> <span class="keyword">int</span>)v5;</span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)v5 ^ data[<span class="number">0</span>]) == <span class="string">&#x27;f&#x27;</span> &amp;&amp; (HIBYTE(v7) ^ (<span class="keyword">unsigned</span> __int8)MEMORY[<span class="number">0x6CC0A3</span>]) == <span class="string">&#x27;g&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">24</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = (<span class="keyword">unsigned</span> __int8)(data[i] ^ *((_BYTE *)&amp;v7 + i % <span class="number">4</span>));</span><br><span class="line">      sub_410E90(v2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  result = v4 ^ v8;</span><br><span class="line">  <span class="keyword">if</span> ( v4 != v8 )</span><br><span class="line">    sub_444020(v2, a2);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟不出个啥玩意，只知道最开始的是flag，前面对V5也有个对比，然后构造一下还原出完整的flag，我始终找不到进入这个for函数的方法，无论输入什么，只能静态分析，v5/v7是干啥的也不清楚，如果能直接分析的话就好多了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data = [  <span class="number">0x40</span>, <span class="number">0x35</span>, <span class="number">0x20</span>, <span class="number">0x56</span>, <span class="number">0x5D</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x45</span>, <span class="number">0x17</span>, <span class="number">0x2F</span>, </span><br><span class="line">  <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0x62</span>, <span class="number">0x3C</span>, <span class="number">0x27</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0x6C</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, </span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0x3C</span>, <span class="number">0x32</span>, <span class="number">0x45</span>, <span class="number">0x5B</span>]</span><br><span class="line">key= <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">key = list(key)</span><br><span class="line">key = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> key]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key)):</span><br><span class="line">    key[i] ^= data[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    data[i] ^= key[i % <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> data]))</span><br></pre></td></tr></table></figure>

<p>出flag<code>flag&#123;Act1ve_Defen5e_Test&#125;</code></p>
<p>好坑啊，花了我一天的时间</p>
<h2 id="BJDCTF-JustRE"><a href="#BJDCTF-JustRE" class="headerlink" title="BJDCTF JustRE"></a>BJDCTF JustRE</h2><p>拖进IDA，通过寻找字符串找到关键函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL __stdcall <span class="title">DialogFunc</span><span class="params">(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  CHAR String; <span class="comment">// [esp+0h] [ebp-64h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">272</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a2 != <span class="number">273</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (_WORD)a3 != <span class="number">1</span> &amp;&amp; (_WORD)a3 != <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sprintf</span>(&amp;String, aD, ++click_time);</span><br><span class="line">      <span class="keyword">if</span> ( click_time == <span class="number">19999</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(&amp;String, aBjdDD2069a4579, <span class="number">19999</span>, <span class="number">0</span>);</span><br><span class="line">        SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      SetWindowTextA(hWnd, &amp;String);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    EndDialog(hWnd, (<span class="keyword">unsigned</span> __int16)a3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>点击次数到了<code>19999</code>就会弹出flag？让我试试这个flag，出了？？？什么鬼，上面的题这么坑，这个题这么简单，居然排在上面的题目后面</p>
<h2 id="SUCTF2019-signin"><a href="#SUCTF2019-signin" class="headerlink" title="SUCTF2019 signin"></a>SUCTF2019 signin</h2><p>是个x86_64的elf，直觉告诉我这种一般都不好搞，虽然只有为数不多的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> n; <span class="comment">// [rsp+0h] [rbp-4A0h]</span></span><br><span class="line">  <span class="keyword">char</span> e; <span class="comment">// [rsp+10h] [rbp-490h]</span></span><br><span class="line">  <span class="keyword">char</span> m; <span class="comment">// [rsp+20h] [rbp-480h]</span></span><br><span class="line">  <span class="keyword">char</span> c; <span class="comment">// [rsp+30h] [rbp-470h]</span></span><br><span class="line">  <span class="keyword">char</span> input; <span class="comment">// [rsp+40h] [rbp-460h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+B0h] [rbp-3F0h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+498h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[sign in]&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[input your flag]: &quot;</span>, a2);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%99s&quot;</span>, &amp;input);</span><br><span class="line">  sub_96A(&amp;input, &amp;v9);</span><br><span class="line">  __gmpz_init_set_str(&amp;c, <span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="number">16L</span>L);</span><br><span class="line">  __gmpz_init_set_str(&amp;m, &amp;v9, <span class="number">16L</span>L);</span><br><span class="line">  __gmpz_init_set_str(&amp;n, <span class="string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>, <span class="number">10L</span>L);</span><br><span class="line">  __gmpz_init_set_str(&amp;e, <span class="string">&quot;65537&quot;</span>, <span class="number">10L</span>L);</span><br><span class="line">  __gmpz_powm((__int64)&amp;m, (__int64)&amp;m, (__int64)&amp;e, (__int64)&amp;n);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)__gmpz_cmp(&amp;m, &amp;c) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GG!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;TTTTTTTTTTql!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>难不成是考察gmpz库的辨认？看这个加密算法有点像是rsa</p>
<p>已知<br>$$<br>n=0Xe4bcdf0332b194a4c28376b1a3c18bf8604a4dc3efe363e00708c402d510e9e5\<br>e = 0X10001\<br>c = 0Xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35<br>$$<br>求m，而$m=c^d % n$</p>
<p>直接分解<code>p=282164587459512124844245113950593348271</code>和<code>q=366669102002966856876605669837014229419</code></p>
<p>然后求得欧拉函数<code>phi = (p-1)*(q-1)</code>，<code>d = gmpy2.invert(65537, phi)</code>，得到d</p>
<p>求<code>m = pow(c, d, n)</code>，解得<code>m = 0x73756374667b50776e5f405f68756e647265645f79656172737d</code></p>
<p>转化一下就出来了<code>suctf&#123;Pwn_@_hundred_years&#125;</code></p>
<h2 id="V-amp-N2020-StrangeCPP"><a href="#V-amp-N2020-StrangeCPP" class="headerlink" title="V&amp;N2020 StrangeCPP"></a>V&amp;N2020 StrangeCPP</h2><p>是个64位exe，吸取上次教训，不能忽略fini函数</p>
<p>然后果然找到了个假flag，然后有个特殊的段<code>00cfg</code>，进去也不知道是干什么的，淦，又是心灵感应题</p>
<p>找一下wp，原来是最开始main_fake在push数据的时候有可疑数据，跟进去</p>
<p>找到关键函数，动态调一下看看参数是啥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_7FF61FD83580</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 *v0; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+128h] [rbp+108h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v3;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v0 = (__int64 *)((<span class="keyword">char</span> *)v0 + <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = <span class="number">-2</span>i64;</span><br><span class="line">  sub_7FF61FD810AA(&amp;unk_7FF61FD97033);</span><br><span class="line">  result = sub_7FF61FD81384((<span class="keyword">unsigned</span> <span class="keyword">int</span>)key);</span><br><span class="line">  v4 = result;</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)result == <span class="number">0x242EE21A</span> &amp;&amp; key &lt;= <span class="number">0xDE02EF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">17</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="keyword">unsigned</span> __int8)(key ^ data[j]));</span><br><span class="line">      result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一次没满足条件，跟进去的话key是8，跑一下看看，发现初步了解过，于是猜测最后一位是<code>&#125;</code>得到key是64，然后就能够得到flag<code>flag&#123;MD5(theNum)&#125;</code></p>
<p>猜num是就是key就是64，然后跑<code>&#39;64&#39;和&#39;@&#39;</code>的MD5都不对，然后进上面的函数跟一下，大概就是要解出这个方程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> __int64 __fastcall <span class="title">solve_it</span><span class="params">(<span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 *v1; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="keyword">int</span> input; <span class="comment">// [rsp+160h] [rbp+140h]</span></span><br><span class="line"></span><br><span class="line">  input = key;</span><br><span class="line">  v1 = &amp;v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v1 = <span class="number">-858993460</span>;</span><br><span class="line">    v1 = (__int64 *)((<span class="keyword">char</span> *)v1 + <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400110AA(&amp;unk_140027033);</span><br><span class="line">  v5 = input &gt;&gt; <span class="number">12</span>;</span><br><span class="line">  v6 = input &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  v7 = (input &lt;&lt; <span class="number">8</span>) ^ (input &gt;&gt; <span class="number">12</span>);</span><br><span class="line">  v7 *= <span class="number">291</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">    result = v7;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="number">987</span>i64;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要我们找到input是啥这里只涉及到v7，直接暴力求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">data = [  <span class="number">0x26</span>, <span class="number">0x2C</span>, <span class="number">0x21</span>, <span class="number">0x27</span>, <span class="number">0x3B</span>, <span class="number">0x0D</span>, <span class="number">0x04</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x34</span>, </span><br><span class="line">  <span class="number">0x28</span>, <span class="number">0x25</span>, <span class="number">0x0E</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x69</span>, <span class="number">0x3D</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">  data[i] ^= <span class="number">64</span></span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> data]))</span><br><span class="line">result = <span class="number">0x242EE21A</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">x</span>):</span></span><br><span class="line">      <span class="keyword">return</span> (<span class="number">0x123</span>*(((x &lt;&lt; <span class="number">8</span>) ^ (x &gt;&gt; <span class="number">12</span>))&amp;<span class="number">0xffffffff</span>)) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0xDE02EF</span>+<span class="number">1</span>):</span><br><span class="line">  <span class="keyword">if</span> enc(x) == result:</span><br><span class="line">    print(<span class="string">&#x27;flag &#123;&#125;&#x27;</span>.format(hashlib.md5(str(x).encode()).hexdigest().lower()))</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><code>e10adc3949ba59abbe56e057f20f883e</code>出了</p>
<h2 id="ACTF-2020-EasyRE"><a href="#ACTF-2020-EasyRE" class="headerlink" title="ACTF 2020 EasyRE"></a>ACTF 2020 EasyRE</h2><p>里面好多个几乎一样的文件，最外面那个是x86的exe，打不开，然后查壳是个UPX，上脱壳机</p>
<p>主函数非常清晰，希望不要是假flag那种坑把</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> idx[<span class="number">12</span>]; <span class="comment">// [esp+12h] [ebp-2Eh]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+1Eh] [ebp-22h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+22h] [ebp-1Eh]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+26h] [ebp-1Ah]</span></span><br><span class="line">  __int16 input; <span class="comment">// [esp+2Ah] [ebp-16h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [esp+2Ch] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [esp+2Dh] [ebp-13h]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [esp+2Eh] [ebp-12h]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [esp+2Fh] [ebp-11h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [esp+33h] [ebp-Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [esp+37h] [ebp-9h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [esp+3Bh] [ebp-5h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+3Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  idx[<span class="number">0</span>] = <span class="number">42</span>;</span><br><span class="line">  idx[<span class="number">1</span>] = <span class="number">70</span>;</span><br><span class="line">  idx[<span class="number">2</span>] = <span class="number">39</span>;</span><br><span class="line">  idx[<span class="number">3</span>] = <span class="number">34</span>;</span><br><span class="line">  idx[<span class="number">4</span>] = <span class="number">78</span>;</span><br><span class="line">  idx[<span class="number">5</span>] = <span class="number">44</span>;</span><br><span class="line">  idx[<span class="number">6</span>] = <span class="number">34</span>;</span><br><span class="line">  idx[<span class="number">7</span>] = <span class="number">40</span>;</span><br><span class="line">  idx[<span class="number">8</span>] = <span class="number">73</span>;</span><br><span class="line">  idx[<span class="number">9</span>] = <span class="number">63</span>;</span><br><span class="line">  idx[<span class="number">10</span>] = <span class="number">43</span>;</span><br><span class="line">  idx[<span class="number">11</span>] = <span class="number">64</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;input);</span><br><span class="line">  <span class="keyword">if</span> ( (_BYTE)input != <span class="number">65</span> || HIBYTE(input) != <span class="number">67</span> || v9 != <span class="number">84</span> || v10 != <span class="number">70</span> || v11 != <span class="number">123</span> || v15 != <span class="number">125</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v5 = v12;</span><br><span class="line">  v6 = v13;</span><br><span class="line">  v7 = v14;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( idx[i] != _data_start__[*((<span class="keyword">char</span> *)&amp;v5 + i) - <span class="number">1</span>] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写个脚本出了，不知道是不是真的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">idx = [<span class="number">0</span>]*<span class="number">12</span></span><br><span class="line">idx[<span class="number">0</span>] = <span class="number">42</span>;</span><br><span class="line">idx[<span class="number">1</span>] = <span class="number">70</span>;</span><br><span class="line">idx[<span class="number">2</span>] = <span class="number">39</span>;</span><br><span class="line">idx[<span class="number">3</span>] = <span class="number">34</span>;</span><br><span class="line">idx[<span class="number">4</span>] = <span class="number">78</span>;</span><br><span class="line">idx[<span class="number">5</span>] = <span class="number">44</span>;</span><br><span class="line">idx[<span class="number">6</span>] = <span class="number">34</span>;</span><br><span class="line">idx[<span class="number">7</span>] = <span class="number">40</span>;</span><br><span class="line">idx[<span class="number">8</span>] = <span class="number">73</span>;</span><br><span class="line">idx[<span class="number">9</span>] = <span class="number">63</span>;</span><br><span class="line">idx[<span class="number">10</span>] = <span class="number">43</span>;</span><br><span class="line">idx[<span class="number">11</span>] = <span class="number">64</span>;</span><br><span class="line">data_start = [<span class="number">0x7e</span>,</span><br><span class="line">  <span class="number">0x7D</span>, <span class="number">0x7C</span>, <span class="number">0x7B</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, </span><br><span class="line">  <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x71</span>, <span class="number">0x70</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x6A</span>, </span><br><span class="line">  <span class="number">0x69</span>, <span class="number">0x68</span>, <span class="number">0x67</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, </span><br><span class="line">  <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, </span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, </span><br><span class="line">  <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, </span><br><span class="line">  <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, </span><br><span class="line">  <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, </span><br><span class="line">  <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, </span><br><span class="line">  <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0x00</span></span><br><span class="line">]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(idx)):</span><br><span class="line">    d = data_start.index(idx[i])</span><br><span class="line">    d += <span class="number">1</span></span><br><span class="line">    flag.append(d)</span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]))</span><br></pre></td></tr></table></figure>

<p><code>ACTF&#123;U9X_1S_W6@T?&#125;</code>出了</p>
<h2 id="GUET-CTF-re"><a href="#GUET-CTF-re" class="headerlink" title="GUET-CTF re"></a>GUET-CTF re</h2><p>ELF-X86-64文件，加载开来只有几个函数，库函数都见不到，看参数应该是加了UPX的壳，脱了</p>
<p>关键函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_4009AE</span><span class="params">(<span class="keyword">char</span> *input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">1629056</span> * *input != <span class="number">166163712</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6771600</span> * input[<span class="number">1</span>] != <span class="number">731332800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3682944</span> * input[<span class="number">2</span>] != <span class="number">357245568</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10431000</span> * input[<span class="number">3</span>] != <span class="number">1074393000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3977328</span> * input[<span class="number">4</span>] != <span class="number">489211344</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5138336</span> * input[<span class="number">5</span>] != <span class="number">518971936</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7532250</span> * input[<span class="number">7</span>] != <span class="number">406741500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5551632</span> * input[<span class="number">8</span>] != <span class="number">294236496</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3409728</span> * input[<span class="number">9</span>] != <span class="number">177305856</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13013670</span> * input[<span class="number">10</span>] != <span class="number">650683500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6088797</span> * input[<span class="number">11</span>] != <span class="number">298351053</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7884663</span> * input[<span class="number">12</span>] != <span class="number">386348487</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8944053</span> * input[<span class="number">13</span>] != <span class="number">438258597</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5198490</span> * input[<span class="number">14</span>] != <span class="number">249527520</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4544518</span> * input[<span class="number">15</span>] != <span class="number">445362764</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3645600</span> * input[<span class="number">17</span>] != <span class="number">174988800</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">10115280</span> * input[<span class="number">16</span>] != <span class="number">981182160</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9667504</span> * input[<span class="number">18</span>] != <span class="number">493042704</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5364450</span> * input[<span class="number">19</span>] != <span class="number">257493600</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">13464540</span> * input[<span class="number">20</span>] != <span class="number">767478780</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">5488432</span> * input[<span class="number">21</span>] != <span class="number">312840624</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">14479500</span> * input[<span class="number">22</span>] != <span class="number">1404511500</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6451830</span> * input[<span class="number">23</span>] != <span class="number">316139670</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">6252576</span> * input[<span class="number">24</span>] != <span class="number">619005024</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7763364</span> * input[<span class="number">25</span>] != <span class="number">372641472</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">7327320</span> * input[<span class="number">26</span>] != <span class="number">373693320</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8741520</span> * input[<span class="number">27</span>] != <span class="number">498266640</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">8871876</span> * input[<span class="number">28</span>] != <span class="number">452465676</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4086720</span> * input[<span class="number">29</span>] != <span class="number">208422720</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">9374400</span> * input[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5759124</span> * input[<span class="number">31</span>] == <span class="number">719890500</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每一位挨着挨着求就是了，想想能不能用正则表达式来自动化一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">_BOOL8 __fastcall sub_4009AE(char *input)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">if ( 1629056 * *input != 166163712 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 6771600 * input[1] != 731332800 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 3682944 * input[2] != 357245568 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 10431000 * input[3] != 1074393000 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 3977328 * input[4] != 489211344 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 5138336 * input[5] != 518971936 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 7532250 * input[7] != 406741500 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 5551632 * input[8] != 294236496 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 3409728 * input[9] != 177305856 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 13013670 * input[10] != 650683500 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 6088797 * input[11] != 298351053 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 7884663 * input[12] != 386348487 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 8944053 * input[13] != 438258597 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 5198490 * input[14] != 249527520 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 4544518 * input[15] != 445362764 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 3645600 * input[17] != 174988800 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 10115280 * input[16] != 981182160 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 9667504 * input[18] != 493042704 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 5364450 * input[19] != 257493600 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 13464540 * input[20] != 767478780 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 5488432 * input[21] != 312840624 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 14479500 * input[22] != 1404511500 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 6451830 * input[23] != 316139670 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 6252576 * input[24] != 619005024 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 7763364 * input[25] != 372641472 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 7327320 * input[26] != 373693320 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 8741520 * input[27] != 498266640 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 8871876 * input[28] != 452465676 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 4086720 * input[29] != 208422720 )</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">if ( 9374400 * input[30] == 515592000 )</span></span><br><span class="line"><span class="string">return 5759124 * input[31] == 719890500;</span></span><br><span class="line"><span class="string">return 0LL;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">text = text.split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">1</span>::<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">  <span class="keyword">if</span> i[:<span class="number">2</span>] == <span class="string">&#x27;if&#x27;</span>:</span><br><span class="line">    numbers1 = re.findall(<span class="string">&quot;\d+ \*&quot;</span>, i)[<span class="number">0</span>][:<span class="number">-2</span>]</span><br><span class="line">    numbers2 = re.findall(<span class="string">&quot;= \d+&quot;</span>, i)[<span class="number">0</span>][<span class="number">2</span>:]</span><br><span class="line">    ch = int(numbers2) / int(numbers1)</span><br><span class="line">    flag.append(ch)</span><br><span class="line"></span><br><span class="line">flag.append(<span class="number">719890500</span>/<span class="number">5759124</span>)</span><br><span class="line">flag = [int(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]</span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join([chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]))</span><br></pre></td></tr></table></figure>

<p>出了<code>flag&#123;e65421110b0a3099a1c039337&#125;</code>，然后一交，不对，长度还是有点问题有个没匹配到，是input[6]，而且还俩移位的</p>
<p>对flag改一下位置<code>flag&#123;e_65421110ba03099a1c039337&#125;</code>，交了一下成功，是多解，但是这个平台还是判错，只能找wp了，淦</p>
<p>最后一位默认是1</p>
<h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="FlareOn4 login"></a>FlareOn4 login</h2><p>是个html，打开之后就是一个login登录框，有点东西</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Html</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>FLARE On 2017<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Enter the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;prompt&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click to check the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Correct flag!&quot;</span>);</span></span><br><span class="line"><span class="javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一个加密，懒得逆算法直接爆破算了，反正咱也看不懂js</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">function encry(c)&#123;return String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">jsc = execjs.compile(jscode)</span><br><span class="line"></span><br><span class="line">out = <span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line">table = string.printable</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encry</span>(<span class="params">s:str</span>):</span></span><br><span class="line">    <span class="keyword">return</span> jsc.call(<span class="string">&quot;encry&quot;</span>, s)</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(out)):</span><br><span class="line">    <span class="keyword">if</span> out[i] <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">        <span class="keyword">for</span> letter <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">if</span> encry(letter) == out[i]:</span><br><span class="line">                flag.append(letter)</span><br><span class="line">                print(letter, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag.append(<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag.append(out[i])</span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line">print([ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag])</span><br><span class="line">print(len(out))</span><br><span class="line">print(len(flag))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>出flag<code>ClientSideLoginsAreEasy@flare-on.com</code>，其中的S还被换成了<code>9</code>，后面猜了一下出了</p>
<h2 id="V-amp-N-2020-CSRe"><a href="#V-amp-N-2020-CSRe" class="headerlink" title="V&amp;N 2020 CSRe"></a>V&amp;N 2020 CSRe</h2><p>是个.Net文件，放在<code>dnspy</code>下面跑一堆乱码，完全没法看，用<code>de4dot</code>看看</p>
<p>关键函数</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x02000006 RID: 6</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">Class3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Token: 0x0600000D RID: 13 RVA: 0x000022C8 File Offset: 0x000004C8</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">method_0</span>(<span class="params"><span class="keyword">string</span> string_0, <span class="keyword">string</span> string_1</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">string</span> text = <span class="keyword">string</span>.Empty;</span><br><span class="line">        <span class="keyword">char</span>[] array = string_0.ToCharArray();</span><br><span class="line">        <span class="keyword">char</span>[] array2 = string_1.ToCharArray();</span><br><span class="line">        <span class="keyword">int</span> num = (array.Length &lt; array2.Length) ? array.Length : array2.Length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            text += (<span class="keyword">int</span>)(array[i] ^ array2[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> text;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0600000E RID: 14 RVA: 0x0000231C File Offset: 0x0000051C</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">smethod_0</span>(<span class="params"><span class="keyword">string</span> string_0</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = Encoding.UTF8.GetBytes(string_0);</span><br><span class="line">        <span class="keyword">byte</span>[] array = SHA1.Create().ComputeHash(bytes);</span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">byte</span> b <span class="keyword">in</span> array)</span><br><span class="line">        &#123;</span><br><span class="line">            stringBuilder.Append(b.ToString(<span class="string">&quot;X2&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stringBuilder.ToString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x0600000F RID: 15 RVA: 0x00002374 File Offset: 0x00000574</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!Class1.smethod_1())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        Class3 @class = <span class="keyword">new</span> Class3();</span><br><span class="line">        <span class="keyword">string</span> str = Console.ReadLine();</span><br><span class="line">        <span class="keyword">if</span> (Class3.smethod_0(<span class="string">&quot;3&quot;</span> + str + <span class="string">&quot;9&quot;</span>) != <span class="string">&quot;B498BFA2498E21325D1178417BEA459EB2CD28F8&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">string</span> text = Console.ReadLine();</span><br><span class="line">        <span class="keyword">string</span> string_ = Class3.smethod_0(<span class="string">&quot;re&quot;</span> + text);</span><br><span class="line">        <span class="keyword">string</span> text2 = @class.method_0(string_, <span class="string">&quot;63143B6F8007B98C53CA2149822777B3566F9241&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; text2.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (text2[i] != <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;flag&#123;&quot;</span> + str + text + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>函数还是比较清楚，先查sha1<code>B498BFA2498E21325D1178417BEA459EB2CD28F8</code>，是314159</p>
<p>然后就是查被xor 之后的sha1 了，他这句<code>text2[i] != &#39;0&#39;</code>看的我很迷，然后就查原文，查到是<code>return</code></p>
<p>所以flag就是<code>flag&#123;1415turn&#125;</code></p>
<h2 id="BJDCTF-easy"><a href="#BJDCTF-easy" class="headerlink" title="BJDCTF easy"></a>BJDCTF easy</h2><p>打开一看</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">time_t</span> v4; <span class="comment">// [esp+10h] [ebp-3F0h]</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> *<span class="title">v5</span>;</span> <span class="comment">// [esp+3FCh] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  time(&amp;v4);</span><br><span class="line">  v5 = localtime(&amp;v4);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you find me?\n&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>？？？看了一下汇编也没啥玩意啊？</p>
<p>看了一下main函数上面那个有点蹊跷</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ques</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v2[<span class="number">50</span>]; <span class="comment">// [esp+20h] [ebp-128h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+E8h] [ebp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+ECh] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+F0h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+F4h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+F8h] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+FCh] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+100h] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+104h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [esp+108h] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [esp+10Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [esp+114h] [ebp-34h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [esp+118h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [esp+124h] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [esp+128h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+12Ch] [ebp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0x7FFA7E31</span>;</span><br><span class="line">  v4 = <span class="number">0x224FC</span>;</span><br><span class="line">  v5 = <span class="number">0x884A4239</span>;</span><br><span class="line">  v6 = <span class="number">0x22A84</span>;</span><br><span class="line">  v7 = <span class="number">0x84FF235</span>;</span><br><span class="line">  v8 = <span class="number">0x3FF87</span>;</span><br><span class="line">  v9 = <span class="number">0x88424233</span>;</span><br><span class="line">  v10 = <span class="number">0x23185</span>;</span><br><span class="line">  v11 = <span class="number">0x7E4243F1</span>;</span><br><span class="line">  v12 = <span class="number">0x231FC</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(v2, <span class="number">0</span>, <span class="keyword">sizeof</span>(v2));</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v0 = *(&amp;v4 + <span class="number">2</span> * i);</span><br><span class="line">    LODWORD(v14) = *(&amp;v3 + <span class="number">2</span> * i);</span><br><span class="line">    HIDWORD(v14) = v0;</span><br><span class="line">    <span class="keyword">while</span> ( SHIDWORD(v14) &gt; <span class="number">0</span> || v14 &gt;= <span class="number">0</span> &amp;&amp; (_DWORD)v14 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2[v16++] = ((SHIDWORD(v14) &gt;&gt; <span class="number">31</span>) ^ (((<span class="keyword">unsigned</span> __int8)(SHIDWORD(v14) &gt;&gt; <span class="number">31</span>) ^ (<span class="keyword">unsigned</span> __int8)v14)</span><br><span class="line">                                          - (<span class="keyword">unsigned</span> __int8)(SHIDWORD(v14) &gt;&gt; <span class="number">31</span>)) &amp; <span class="number">1</span>)</span><br><span class="line">                - (SHIDWORD(v14) &gt;&gt; <span class="number">31</span>);</span><br><span class="line">      v14 /= <span class="number">2L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">50</span>; j &gt;= <span class="number">0</span>; --j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v2[j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2[j] == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">putchar</span>(<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">          ++v15;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        ++v15;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v15 % <span class="number">5</span>) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是查找交叉引用缺啥也没有，改一下eip看看直接执行这个函数，执行结果是这个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*   *   *   ***** *   * ***** ***** * *   ***** *   * *   *</span><br><span class="line">*   *  * *  *     *  *    *     *   * *   *     *   * **  *</span><br><span class="line">***** ***** *     ***     *     *   ***** ***   *   * * * *</span><br><span class="line">*   * *   * *     * **    *     *     *   *     *   * *  **</span><br><span class="line">*   * *   * ***** *   * *****   *     *   *     ***** *   *</span><br><span class="line">*   *   *   ***** *   * ***** ***** * *   ***** *   * *   *</span><br><span class="line">*   *  * *  *     *  *    *     *   * *   *     *   * **  *</span><br><span class="line">***** ***** *     ***     *     *   ***** ***   *   * * * *</span><br><span class="line">*   * *   * *     * **    *     *     *   *     *   * *  **</span><br><span class="line">*   * *   * ***** *   * *****   *     *   *     ***** *   *</span><br></pre></td></tr></table></figure>

<p>是<code>HACKIT4FUN</code>，出了</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">damaoooo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/08/09/BUUCTF%20Reverse%20WriteUp%202/">http://yoursite.com/2020/08/09/BUUCTF%20Reverse%20WriteUp%202/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">damaoooo's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Re/">Re</a></div><div class="post_share"><div class="social-share" data-image="https://img.buuoj.cn/buugirl/img/1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/12/BUUCTF%20Reverse%20WriteUp%203/"><img class="prev-cover" data-lazy-src="https://img.buuoj.cn/buugirl/img/1.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF Reverse WriteUp 3</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/06/RSA%E5%8A%A0%E5%AF%86%E8%AF%A6%E8%A7%A3/"><img class="next-cover" data-lazy-src="https://i.loli.net/2020/08/06/RtLdEl9INg35ujf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CTF 中的 RSA 算法详解</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/09/30/BUUCTF RE WP4/" title="BUUCTF Reverse WriteUp 4"><img class="relatedPosts_cover" data-lazy-src="https://img2.woyaogexing.com/2020/07/30/cd0326e40dd049e49e28fd958622947b!400x400.webp"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-30</div><div class="relatedPosts_title">BUUCTF Reverse WriteUp 4</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/12/BUUCTF Reverse WriteUp 3/" title="BUUCTF Reverse WriteUp 3"><img class="relatedPosts_cover" data-lazy-src="https://img.buuoj.cn/buugirl/img/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-12</div><div class="relatedPosts_title">BUUCTF Reverse WriteUp 3</div></div></a></div><div class="relatedPosts_item"><a href="/2020/07/30/BUUCTF Reverse WriteUp/" title="BUUCTF Reverse WriteUp 1"><img class="relatedPosts_cover" data-lazy-src="https://img.buuoj.cn/buugirl/img/1.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-30</div><div class="relatedPosts_title">BUUCTF Reverse WriteUp 1</div></div></a></div><div class="relatedPosts_item"><a href="/2019/04/15/DDCTF re1 writeup/" title="DDCTF_re1_writeup"><img class="relatedPosts_cover" data-lazy-src="https://i.loli.net/2019/09/11/T8p92g5ijaJnEVP.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-15</div><div class="relatedPosts_title">DDCTF_re1_writeup</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/23/Pintools和angr 在linux和windows下的安装与使用/" title="Pintools/angr 在 Linux/Windows 下的安装与使用"><img class="relatedPosts_cover" data-lazy-src="https://img2.woyaogexing.com/2020/07/30/9bc6cd92f7f649a19a6efd982ce4b413!400x400.webp"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-23</div><div class="relatedPosts_title">Pintools/angr 在 Linux/Windows 下的安装与使用</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/06/RSA加密详解/" title="CTF 中的 RSA 算法详解"><img class="relatedPosts_cover" data-lazy-src="https://i.loli.net/2020/08/06/RtLdEl9INg35ujf.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-06</div><div class="relatedPosts_title">CTF 中的 RSA 算法详解</div></div></a></div></div></div></article></main><footer id="footer" style="background-image: url(https://img.buuoj.cn/buugirl/img/1.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By damaoooo</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎经常来康康~</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  var script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js', function () {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"> <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script>
<div class="aplayer" data-id="497592050" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-order="random" data-volume="0.55" data-theme="#49b1f5" data-preload="auto" > </div><script id="canvas_nest" defer="defer" color="0,0,0" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/third-party/click_heart.js" async="async"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: [
    'title',
    'meta[name=description]',
    '#config_change',
    '#body-wrap',
    '#rightside-config-hide',
    '#rightside-config-show',
    '.js-pjax'
  ],
  cacheBust: false,
})

document.addEventListener('pjax:complete', function () {
  refreshFn()

  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

})

document.addEventListener('pjax:send', function () {
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

  //reset font-size
  $('body').css('font-size') !== originFontSize && $('body').css('font-size', parseFloat(originFontSize))
})</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>